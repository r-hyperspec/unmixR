<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="unmixR">
<title> • unmixR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="">
<meta property="og:description" content="unmixR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">unmixR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.2.339</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/IntroUnmixR.html">UNKNOWN TITLE</a>
    <a class="dropdown-item" href="../articles/ice.html">UNKNOWN TITLE</a>
    <a class="dropdown-item" href="../articles/unmixUnittests.html">UNKNOWN TITLE</a>
    <a class="dropdown-item" href="../articles/vca.html">UNKNOWN TITLE</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/r-hyperspec/unmixR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1></h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/r-hyperspec/unmixR/blob/HEAD/vignettes/vca.Rmd" class="external-link"><code>vignettes/vca.Rmd</code></a></small>
      <div class="d-none name"><code>vca.Rmd</code></div>
    </div>

    
    
<!--
%\VignetteEngine{knitr::knitr}
%\VignetteIndexEntry{VCA with unmixR}
%\VignetteKeywords{hyperspectral unmixing, vertex component analysis, VCA}
%\VignetteDepends{plot3D, scatterplot3d}
 -->
<div class="section level2">
<h2 id="vca-with-unmixr">VCA with unmixR<a class="anchor" aria-label="anchor" href="#vca-with-unmixr"></a>
</h2>
<p>Anton Belov, July 1, 2016</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R">    <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">plot3D</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Warning: no DISPLAY variable so Tk is not available</span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R">    <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-hyperspec.github.io/hyperSpec/" class="external-link">hyperSpec</a></span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Package hyperSpec, version 0.100.0</span>
<span class="co">## </span>
<span class="co">## To get started, try</span>
<span class="co">##    vignette ("hyperspec")</span>
<span class="co">##    package?hyperSpec </span>
<span class="co">##    vignette (package = "hyperSpec")</span>
<span class="co">## </span>
<span class="co">## If you use this package please cite it appropriately.</span>
<span class="co">##    citation("hyperSpec")</span>
<span class="co">## will give you the correct reference.</span>
<span class="co">## </span>
<span class="co">## The project homepage is http://hyperspec.r-forge.r-project.org</span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R">    <span class="va">d</span> <span class="op">&lt;-</span> <span class="fu">unmixR</span><span class="fu">:::</span><span class="va">.testdata</span><span class="op">$</span><span class="va">x</span>
    <span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##  'AsIs' num [1:10, 1:3] 0 1 2 3 0 1 2 0 1 0 ...</span>
<span class="co">##  - attr(*, "dimnames")=List of 2</span>
<span class="co">##   ..$ samples    : chr [1:10] "1" "2" "3" "4" ...</span>
<span class="co">##   ..$ wavelengths: chr [1:3] "L1" "L2" "L3"</span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R">    <span class="fu"><a href="https://rdrr.io/pkg/plot3D/man/scatter.html" class="external-link">scatter3D</a></span><span class="op">(</span><span class="va">d</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, <span class="va">d</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, <span class="va">d</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span>, pch <span class="op">=</span> <span class="fl">20</span>, col <span class="op">=</span> <span class="fu"><a href="https://r-hyperspec.github.io/hyperSpec/reference/palettes.html" class="external-link">matlab.dark.palette</a></span><span class="op">(</span><span class="op">)</span>, phi <span class="op">=</span> <span class="fl">50</span>, theta <span class="op">=</span> <span class="fl">110</span><span class="op">)</span></code></pre></div>
<p><img src="vca_files/figure-html/unnamed-chunk-1-1.png" width="465.984"></p>
<div class="section level3">
<h3 id="dimensionality-reduction">Dimensionality Reduction<a class="anchor" aria-label="anchor" href="#dimensionality-reduction"></a>
</h3>
<p>The algorithm uses two dimensionality reduction techniques. The choice depends on the signal to noise ratio of data. The threshold value is equal to <span class="math inline">\(15 + 10 \log p\)</span> The dimensionality reduction function not only reduces dimensionality of data but also transforms it to amplify noise.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R">    <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-hyperspec.github.io/unmixr/" class="external-link">unmixR</a></span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] 10  3</span></code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R">    <span class="va">endNum</span> <span class="op">&lt;-</span> <span class="fl">3</span>
    <span class="va">snrThreshhold</span> <span class="op">&lt;-</span> <span class="fl">15</span> <span class="op">+</span> <span class="fl">10</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">endNum</span><span class="op">)</span>
    <span class="va">sameReduced</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dimensionalityReduction.html">dimensionalityReduction</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">endNum</span>, <span class="va">snrThreshhold</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>
    <span class="va">lowerReduced</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dimensionalityReduction.html">dimensionalityReduction</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">endNum</span>, <span class="va">snrThreshhold</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="plotting-the-data">Plotting the Data<a class="anchor" aria-label="anchor" href="#plotting-the-data"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R">    <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">scatterplot3d</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
    <span class="fu"><a href="https://r-hyperspec.github.io/hyperSpec/reference/dimnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">sameReduced</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"z"</span><span class="op">)</span>
    <span class="fu"><a href="https://r-hyperspec.github.io/hyperSpec/reference/dimnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">lowerReduced</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"z"</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/pkg/scatterplot3d/man/scatterplot3d.html" class="external-link">scatterplot3d</a></span><span class="op">(</span><span class="va">sameReduced</span>, main <span class="op">=</span> <span class="st">"given dimensionality reduced data"</span><span class="op">)</span></code></pre></div>
<p><img src="vca_files/figure-html/unnamed-chunk-3-1.png" width="465.984"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R">    <span class="fu"><a href="https://rdrr.io/pkg/scatterplot3d/man/scatterplot3d.html" class="external-link">scatterplot3d</a></span><span class="op">(</span><span class="va">lowerReduced</span>, main <span class="op">=</span> <span class="st">"lower dimensionality reduced data"</span><span class="op">)</span></code></pre></div>
<p><img src="vca_files/figure-html/unnamed-chunk-4-1.png" width="465.984"></p>
<p>Using the second approach, the algorithm projects the data onto a subspace of even lower dimensionality and then sets the “missing” dimension values to a certain value. That is why points colored in red have the same z value, because the data was reduced to the dimensionality of 2 (x and y) and then the z value was set to a certain number.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R">    <span class="va">my3dplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scatterplot3d/man/scatterplot3d.html" class="external-link">scatterplot3d</a></span><span class="op">(</span><span class="va">lowerReduced</span>, color <span class="op">=</span> <span class="st">"red"</span>,
      zlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"transformed data"</span><span class="op">)</span>
    <span class="va">my3dplot</span><span class="op">$</span><span class="fu">points3d</span><span class="op">(</span><span class="va">sameReduced</span>, type <span class="op">=</span> <span class="st">"h"</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"bottomright"</span>, pch <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"red"</span><span class="op">)</span>,
      legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"same"</span>, <span class="st">"lower"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="vca_files/figure-html/unnamed-chunk-5-1.png" width="465.984"></p>
<p>Since the noise in this example is very low the algorithm will use the first approach.</p>
</div>
<div class="section level3">
<h3 id="the-vca-process-illustrated">The VCA Process, Illustrated<a class="anchor" aria-label="anchor" href="#the-vca-process-illustrated"></a>
</h3>
<p>The VCA algorithm works as follows:</p>
<ol style="list-style-type: decimal">
<li>The data is reduced to a dimensionality equal to <span class="math inline">\(p\)</span> where <span class="math inline">\(p\)</span> is the desired (estimated) number of endmembers. As mentioned above, the details of the reduction depend upon the signal-to-noise ratio of the raw data.</li>
<li>Initialize <span class="math inline">\(A\)</span>, a <span class="math inline">\(p \times p\)</span> matrix that will store the endmembers. The first column is set to a constant, which represents an initial “fake” endmember to get the process started.</li>
<li>For <span class="math inline">\(i\)</span> from 1 to <span class="math inline">\(p\)</span>:
<ul>
<li>Calculate a reference vector orthogonal to the subspace spanned by columns of <span class="math inline">\(A\)</span>. This vector will pass through (0,0,…,0).</li>
<li>Project all the data points onto this reference vector.</li>
<li>Find which data point’s projection onto the reference vector is furthest from the origin. This is equivalent to the data point which has the maximum absolute projection onto the reference vector.</li>
<li>Let <span class="math inline">\(k\)</span> be the index of that data point in the dataset. Set the <span class="math inline">\(i\)</span>-th column of <span class="math inline">\(A\)</span> to <span class="math inline">\(k\)</span>-th column of data. This is one of the endmembers.</li>
</ul>
</li>
<li>Return <span class="math inline">\(A\)</span>.</li>
</ol>
<p>The following plots illustrate the process for a 3-dimensional data set consisting of a number of points which lie on a plane and form a triangle.</p>
<p>The system is initialized with a “fake” endmember with coordinates <span class="math inline">\((0,0,1)\)</span> and a reference vector <span class="math inline">\(f\)</span> which is orthogonal to this endmember (point) is computed. Then, each data point is projected onto this reference vector. The data point whose projection intersection with <span class="math inline">\(f\)</span> is farthest from the origin is selected as the first (real) endmember (and the fake endmember is discarded). The next plot shows these steps. The first endmember is at the lower-left.</p>
<p><img src="vca_files/figure-html/unnamed-chunk-8-1.png" width="465.984"></p>
<p>The first real endmember is then used to construct a new reference vector <span class="math inline">\(f\)</span> and once again the data points are projected onto <span class="math inline">\(f\)</span> and the projection intersection with <span class="math inline">\(f\)</span> which is farthest from the origin is selected as the next endmember. In the following plot, the 2nd endmember selected is the top-most data point.</p>
<p><img src="vca_files/figure-html/unnamed-chunk-9-1.png" width="465.984"></p>
<p>With two endmembers identified, we continue the process starting from the most recently identified endmember. In this next plot, the 3rd endmember is the right-most data point. It’s projection onto the reference vector <span class="math inline">\(f\)</span> is very short and not visible as the data point nearly falls on <span class="math inline">\(f\)</span>. In this plot and the next, we are carrying along the vectors which were used to construct the reference vectors <span class="math inline">\(f\)</span> at each step.</p>
<p><img src="vca_files/figure-html/unnamed-chunk-10-1.png" width="465.984"></p>
<p>Finally all endmembers have been identified.</p>
<p><img src="vca_files/figure-html/unnamed-chunk-11-1.png" width="465.984"></p>
<p>If this process were extended to <span class="math inline">\(p\)</span>-dimensions, each reference vector <span class="math inline">\(f\)</span> would be a line in the <span class="math inline">\(p\)</span>-dimensional space. Thus the process would be to choose a point, construct an orthogonal vector <span class="math inline">\(f\)</span>, and determine which data point has the most extreme projection onto this vector. That point is chosen as an endmember and the process is repeated until all the desired endmembers have been identified.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Anton Belov, Conor McManus, Claudia Beleites, Bryan A. Hanson, Simon Fuller.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.4.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
